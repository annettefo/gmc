<form theme="dark">
  <label>Splunk - SH - 04 - Audit Search Activity - Dashboard - v1</label>
  <description>Audit all Splunk Search Activities using one normalized Data Model for Audit, Introspection &amp; Internal</description>
  <search id="splunk_sh_04_audit_search_activity_dashboard_introspection_search_usage">
    <query>
| tstats SUMMARIESONLY=TRUE ALLOW_OLD_SUMMARIES=FALSE 
    latest(Search_Activity.Introspection_Search_Usage.acceleration_id) AS acceleration_id
    latest(Search_Activity.Introspection_Search_Usage.app3) AS app
    max(Search_Activity.Introspection_Search_Usage.delta_scan_count) AS delta_scan_count
    max(Search_Activity.Introspection_Search_Usage.total_run_time3) AS total_run_time
    max(Search_Activity.Introspection_Search_Usage.fd_used) AS fd_used
    max(Search_Activity.Introspection_Search_Usage.mem_used) AS mem_used
    max(Search_Activity.Introspection_Search_Usage.normalized_pct_cpu) AS normalized_pct_cpu
    max(Search_Activity.Introspection_Search_Usage.page_faults) AS page_faults
    max(Search_Activity.Introspection_Search_Usage.pct_cpu) AS pct_cpu
    max(Search_Activity.Introspection_Search_Usage.pct_memory) AS pct_memory
    latest(Search_Activity.Introspection_Search_Usage.provenance) AS provenance
    max(Search_Activity.Introspection_Search_Usage.read_mb) AS read_mb
    latest(Search_Activity.Introspection_Search_Usage.savedsearch_name3) AS savedsearch_name
    max(Search_Activity.Introspection_Search_Usage.scan_count3) AS scan_count
    latest(Search_Activity.Introspection_Search_Usage.search_type3) AS search_type
    latest(Search_Activity.Introspection_Search_Usage.status) AS status
    max(Search_Activity.Introspection_Search_Usage.t_count) AS t_count
    latest(Search_Activity.Introspection_Search_Usage.user3) AS user
    max(Search_Activity.Introspection_Search_Usage.written_mb) AS written_mb
    latest(Search_Activity.Introspection_Search_Usage.search_head) as search_head
    latest(Search_Activity.Introspection_Search_Usage.mode) as mode
    latest(Search_Activity.Introspection_Search_Usage.ppid) as ppid
    values(host) as host
    latest(_time) as _time
  
    FROM DATAMODEL=GMC
  
    WHERE nodename=Search_Activity.Introspection_Search_Usage
    index=_introspection
    AND Search_Activity.Introspection_Search_Usage.app3 = "$app$"
    AND Search_Activity.Introspection_Search_Usage.search_type3 = "$search_type$"
    AND Search_Activity.Introspection_Search_Usage.user3 = "$user$"
    AND Search_Activity.Introspection_Search_Usage.savedsearch_name3 = "$savedsearch_name$"
    AND Search_Activity.Introspection_Search_Usage.search_head = "$search_head$"
    AND Search_Activity.Introspection_Search_Usage.pid = "$pid$"
    AND Search_Activity.Introspection_Search_Usage.total_run_time3 &gt; $total_run_time$ 
    AND Search_Activity.Introspection_Search_Usage.mode = "$mode$"
    AND host="$host$"
    $Exclutions3$
  
    BY Search_Activity.Introspection_Search_Usage.search_id Search_Activity.Introspection_Search_Usage.pid

| `gmc_drop_dm_object_name(Search_Activity.Introspection_Search_Usage)`

| fields _time host search_id search_head app user acceleration_id delta_scan_count total_run_time fd_used mem_used normalized_pct_cpu page_faults pct_cpu pct_memory pid ppid provenance read_mb savedsearch_name scan_count search_type status t_count written_mb mode

| fillnull value=0 delta_scan_count total_run_time fd_used mem_used normalized_pct_cpu page_faults pct_cpu pct_memory read_mb scan_count t_count written_mb 

| fillnull value="Undefined" search_head app user acceleration_id provenance savedsearch_name search_type status mode

| eval mem_used=round(mem_used/1024, 2) 

| `normalize_search_id(search_id)`

| rex field=acceleration_id "_DM_(?&lt;datamodel&gt;.*)" 
| eval acceleration_id_report=if(type="report_acceleration", acceleration_id, null()) 
| eval datamodel_acceleration=if(provenance="summary_director", acceleration_id, null()) 
| rex field=acceleration_id_report "_(?&lt;accelerated_report&gt;\w+$)"
| eval host=upper(host) , search_head=upper(search_head)

| rex field=datamodel mode=sed "s/^Splunk_SA_CIM_|^search_|^splunk_global_monitoring_console_|^splunk_app_aws_|^SA-\w+_|^DA-ESS-\w+_//g" 

| `get_provenance_fields(provenance)`

| `get_instance_info(host)`

| `get_search_concurrency(host, search)`
| `get_search_concurrency(host, scheduler)`

| fields - acceleration_id_report datamodel_acceleration

| `get_saved_searches_info(host,app,savedsearch_name)` | `get_saved_searches_info(app,savedsearch_name)` | `get_saved_searches_info(avedsearch_name)`

| `get_dashboards_info(host,app,Provenance_KO)` | `get_dashboards_info(app,Provenance_KO)` | `get_dashboards_info(Provenance_KO)` | `get_dashboards_usage(host,app,Provenance_KO)`

| `get_identity_info(user)`

| fillnull value="Undefined" search_id_normalized datamodel Provenance_Type Provenance_KO_Type Provenance_KO Splunk_Roles Dashboard_Name savedsearch_type Lookup_Reference Datamodel_Reference LOB Department work_city work_region work_country

| search search_id_normalized = "*$search_id_normalized$*" mem_used &gt;= $mem_used$ datamodel="$datamodel$" Provenance_Type="$Provenance_Type$" Provenance_KO_Type="$Provenance_KO_Type$" Provenance_KO="$Provenance_KO$" LOB="$LOB$" Department = "$Department$" work_city="$work_city$" work_region="$work_region$" work_country="$work_country$" Splunk_Roles="$Splunk_Roles$" savedsearch_type="$savedsearch_type$" Lookup_Reference="$Lookup_Reference$" Datamodel_Reference="$Datamodel_Reference$" 

      </query>
    <earliest>$IntrospectionTimeRangePkr.earliest$</earliest>
    <latest>$IntrospectionTimeRangePkr.latest$</latest>
  </search>
  <search id="splunk_sh_04_audit_search_activity_dashboard_audit_search">
    <query>
| tstats SUMMARIESONLY=TRUE ALLOW_OLD_SUMMARIES=FALSE 
    latest(Search_Activity.Audit_Search.available_count) AS available_count
    latest(Search_Activity.Audit_Search.considered_events) AS considered_events
    latest(Search_Activity.Audit_Search.datamodel1) AS datamodel
    latest(Search_Activity.Audit_Search.decompressed_slices) AS decompressed_slices
    latest(Search_Activity.Audit_Search.event_count) AS event_count
    latest(Search_Activity.Audit_Search.dispatch_time1) AS dispatch_time
    latest(Search_Activity.Audit_Search.exec_time) AS exec_time
    latest(Search_Activity.Audit_Search.result_count1) AS result_count
    latest(Search_Activity.Audit_Search.roles) AS roles
    latest(Search_Activity.Audit_Search.savedsearch_name1) AS savedsearch_name
    latest(Search_Activity.Audit_Search.scan_count1) AS scan_count
    latest(Search_Activity.Audit_Search.search) AS search
    latest(Search_Activity.Audit_Search.search_et) AS search_et
    latest(Search_Activity.Audit_Search.search_lt) AS search_lt
    latest(Search_Activity.Audit_Search.search_startup_time) AS search_startup_time
    latest(Search_Activity.Audit_Search.search_type1) AS search_type
    latest(Search_Activity.Audit_Search.searched_buckets) AS searched_buckets
    latest(Search_Activity.Audit_Search.total_run_time1) AS total_run_time
    latest(Search_Activity.Audit_Search.total_slices) AS total_slices
    latest(Search_Activity.Audit_Search.user1) AS user
    values(host) as host
   
    FROM DATAMODEL=GMC
   
    WHERE nodename=Search_Activity.Audit_Search
    index=_audit
    AND Search_Activity.Audit_Search.search_type1 = "$search_type$"
    AND Search_Activity.Audit_Search.info1 = "$info$"
    AND Search_Activity.Audit_Search.user1 = "$user$"
    AND Search_Activity.Audit_Search.savedsearch_name1 = "$savedsearch_name$"
    AND host = "$host$"
    $Exclutions1$
   
    BY _time Search_Activity.Audit_Search.search_id Search_Activity.Audit_Search.info1 $span_period$

| `gmc_drop_dm_object_name(Search_Activity.Audit_Search)`

| rename info1 AS info

| fields _time host available_count considered_events datamodel decompressed_slices event_count dispatch_time exec_time info result_count roles savedsearch_name scan_count search search_et search_id search_lt search_startup_time search_type searched_buckets total_run_time total_slices user

| eval search_class = case(match(search, "\|\s*rest"), "Rest", match(search, "\|\s*tstats"), "Tstats", true(), "Other")

| rex field=search mode=sed "s/^search\s//g"

| eval search=if(search="search", null(), search)

| eval search_size = len(search) 

| `normalize_search_id(search_id)`

| rex field=savedsearch_name "^_ACCELERATE_DM_(?&lt;datamodel&gt;.*)\.(?&lt;dataset&gt;.*?)_ACCELERATE_$" 
| eval savedsearch_name2 = if(isnull(datamodel) AND savedsearch_name!="N/A", savedsearch_name, null()) 
| rex field=savedsearch_name2 "^_ACCELERATE_DM_(?&lt;datamodel&gt;.*)_ACCELERATE_$"
| rex field=search max_match=0 "[dD][aA][tT][aA][mM][oO][dD][eE][lL][=:]\"?(?&lt;datamodel&gt;\w+)" 
| rex field=search max_match=0 "[dD][aA][tT][aA][mM][oO][dD][eE][lL][=:]\"?\w+\.(?&lt;dataset&gt;\w+)" 
| rex field=search max_match=0 "nodename=\"?(?&lt;dataset&gt;\w+)"
| eval host=upper(host)

| rex field=datamodel mode=sed "s/^Splunk_SA_CIM_|^search_|^splunk_global_monitoring_console_|^splunk_app_aws_|^SA-\w+_|^DA-ESS-\w+_//g" 
| eval Datamodel=trim(Datamodel)
| `get_lookup_reference(search)`

| `get_instance_info(host)`

| `get_identity_info(user)`

| `get_saved_searches_info(host,savedsearch_name)` | `get_saved_searches_info(savedsearch_name)`

| rex max_match=0 field=search "index\s*=[\s\"_]*(?&lt;Index_Name&gt;\S+)" | rex mode=sed field=Index_Name "s/[\"),]//g" 
| rex max_match=0 field=search "sourcetype\s*=\s*\"?(?&lt;Source_Type&gt;\S+)" | rex mode=sed field=Source_Type "s/[\"),]//g" 
| eval Index_Name = case(match(Index_Name, "\*"), "All non-internal indexes", match(Index_Name, "_\*"), "All internal indexes", true(), Index_Name)

| fillnull value=0 available_count considered_events decompressed_slices event_count result_count scan_count searched_buckets total_run_time total_slices search_size

| fillnull value="Undefined" host datamodel info roles savedsearch_name savedsearch_type search_id search_type user search_class search_id_normalized dataset Author_Roles Splunk_Roles search identity Name Title Phone Email Emp_Type Emp_Status work_city work_region work_country Region Location_Code Floor_Number startDate endDate Department LOB Cost_Center Manager Contractor_Expiration Index_Name Source_Type Source

| search search_id_normalized="*$search_id_normalized$*" search="*$search$*" total_run_time&gt;$total_run_time$ search_class="$search_class$" search_size&gt;$search_size$ datamodel="$datamodel$" dataset="$dataset$" searched_buckets&gt;$searched_buckets$ LOB="$LOB$" Department="$Department$" work_city="$work_city$" work_region="$work_region$" work_country="$work_country$" Splunk_Roles="$Splunk_Roles$" Lookup_Reference="$Lookup_Reference$" savedsearch_type="$savedsearch_type$" Index_Name="$Index_Name$" Source_Type="$Source_Type$" datamodel="$datamodel$"

</query>
    <earliest>$AuditTimeRangePkr.earliest$</earliest>
    <latest>$AuditTimeRangePkr.latest$</latest>
  </search>
  <search id="splunk_sh_04_audit_search_activity_dashboard_internal_scheduler">
    <query>
| tstats SUMMARIESONLY=TRUE ALLOW_OLD_SUMMARIES=FALSE
    latest(Search_Activity.Internal_Scheduler.app2) AS app
    latest(Search_Activity.Internal_Scheduler.concurrency_category) AS concurrency_category
    latest(Search_Activity.Internal_Scheduler.concurrency_context) AS concurrency_context
    latest(Search_Activity.Internal_Scheduler.concurrency_limit) AS concurrency_limit
    latest(Search_Activity.Internal_Scheduler.dispatch_time2) AS dispatch_time
    latest(Search_Activity.Internal_Scheduler.priority) AS priority
    latest(Search_Activity.Internal_Scheduler.reason) AS reason
    latest(Search_Activity.Internal_Scheduler.result_count2) AS result_count
    latest(Search_Activity.Internal_Scheduler.total_run_time2) AS total_run_time
    latest(Search_Activity.Internal_Scheduler.savedsearch_id) AS savedsearch_id
    latest(Search_Activity.Internal_Scheduler.savedsearch_name2) AS savedsearch_name
    latest(Search_Activity.Internal_Scheduler.scheduled_time) AS scheduled_time
    latest(Search_Activity.Internal_Scheduler.search_type2) AS search_type
    latest(Search_Activity.Internal_Scheduler.skipped_count) AS skipped_count
    latest(Search_Activity.Internal_Scheduler.info2) AS info
    latest(Search_Activity.Internal_Scheduler.user2) AS user
    latest(Search_Activity.Internal_Scheduler.window_time) AS window_time
    latest(Search_Activity.Internal_Scheduler.alert_actions) AS alert_actions
    values(host) as host
   
    FROM DATAMODEL=GMC
   
    WHERE nodename=Search_Activity.Internal_Scheduler
    index=_internal
    AND Search_Activity.Internal_Scheduler.savedsearch_name2 = "$savedsearch_name$"
    AND Search_Activity.Internal_Scheduler.app2 = "$app$"
    AND Search_Activity.Internal_Scheduler.search_type2 = "$search_type$" 
    AND Search_Activity.Internal_Scheduler.info2 = "$info$"
    AND Search_Activity.Internal_Scheduler.user2 = "$user$"
    AND host = "$host$"
    AND $Exclutions2$
   
    BY _time Search_Activity.Internal_Scheduler.search_id $span_period$

| `gmc_drop_dm_object_name(Search_Activity.Internal_Scheduler)`

| fields _time host app search_id_normalized concurrency_category concurrency_context concurrency_limit dispatch_time priority reason result_count total_run_time savedsearch_id savedsearch_name scheduled_time search_id search_type skipped_count info user window_time alert_actions

| eval user = if(user = "nobody", "splunk-system-user", user)
| rex field=savedsearch_name "_ACCELERATE_DM_(?&lt;app&gt;.*?)_"
| eval savedsearch_name = case(match(savedsearch_name, "_ACCELERATE_|^search\d+"), null(), true(), savedsearch_name)
| eval window_time = if(window_time="-1", "auto", window_time) 

| `normalize_search_id(search_id)`

| rex field=savedsearch_id "(?&lt;DM_User&gt;^.*?);(?&lt;DM_App&gt;.*?);_ACCELERATE_DM_(?&lt;datamodel&gt;.*)_ACCELERATE_$"

| rex field=datamodel mode=sed "s/^Splunk_SA_CIM_|^search_|^splunk_global_monitoring_console_|^splunk_app_aws_|^SA-\w+_|^DA-ESS-\w+_//g" 
| eval Datamodel=trim(Datamodel)

| `get_instance_info(host)`

| `get_identity_info(user)`

| `get_saved_searches_info(host,app,savedsearch_name)` | `get_saved_searches_info(app,savedsearch_name)`

| fillnull value="auto" window_time
| fillnull value=0 concurrency_limit result_count total_run_time skipped_count allow_skew
| fillnull value="Undefined" host app search_id_normalized concurrency_category concurrency_context priority reason savedsearch_id savedsearch_name search_id search_type info user window_time alert_actions Author_Roles Splunk_Roles Name Title Phone Email Emp_Type Emp_Status work_city work_region work_country Region Location_Code Floor_Number startDate endDate Department LOB Cost_Center Manager Contractor_Expiration savedsearch_type

| search search_id_normalized = "*$search_id_normalized$*" AND priority="$priority$" AND window_time="$window_time$" AND concurrency_category="$concurrency_category$" AND concurrency_context="$concurrency_context$" AND concurrency_limit="$concurrency_limit$" AND reason="$reason$" AND total_run_time &gt; $total_run_time$ AND LOB="$LOB$" AND Department = "$Department$" AND work_city="$work_city$" AND work_region="$work_region$" AND work_country="$work_country$" Splunk_Roles="$Splunk_Roles$" savedsearch_type="$savedsearch_type$" allow_skew="$allow_skew$"

      </query>
    <earliest>$InternalTimeRangePkr.earliest$</earliest>
    <latest>$InternalTimeRangePkr.latest$</latest>
  </search>
  <fieldset submitButton="true" autoRun="true">
    <input type="dropdown" token="span_period" searchWhenChanged="true">
      <label>Span:</label>
      <default>span=1s</default>
      <choice value="">Automatic</choice>
      <choice value="span=1s">1 seconds</choice>
      <choice value="span=5s">5 seconds</choice>
      <choice value="span=10s">10 seconds</choice>
      <choice value="span=15s">15 seconds</choice>
      <choice value="span=30s">30 seconds</choice>
      <choice value="span=1m">1 minute</choice>
      <choice value="span=5m">5 minutes</choice>
      <choice value="span=10m">10 minutes</choice>
      <choice value="span=15m">15 minutes</choice>
      <choice value="span=30m">30 minutes</choice>
      <choice value="span=45m">45 minutes</choice>
      <choice value="span=1h">1 hour</choice>
      <choice value="span=2h">2 hours</choice>
      <choice value="span=3h">3 hours</choice>
      <choice value="span=4h">4 hours</choice>
      <choice value="span=6h">6 hours</choice>
      <choice value="span=8h">8 hours</choice>
      <choice value="span=12h">12 hours</choice>
      <choice value="span=1d">1 day</choice>
      <choice value="span=1w">1 week</choice>
      <choice value="span=1mon">1 month</choice>
      <choice value="span=12mon">1 year</choice>
      <initialValue>span=1s</initialValue>
    </input>
  </fieldset>
  <row id="style_settings" depends="$visible$">
    <panel depends="$alwaysHideCSS$">
      <html>
                <style>
                    <!--.dashboard-body {-->
                    <!--    background: #a6a6a6 !important;-->
                    <!--}-->
           .dashboard-panel h2{
             background:#FFA500 !important;
             color:black !important;
             text-align: center !important;
             font-weight: bold !important;
             border-top-right-radius: 15px;
             border-top-left-radius: 15px; }
            .dashboard-panel h1.panel-title {
              font-weight: bold !important;
              font-size: 100% !important; }
                .table, th, td {
              border: 8px solid black !important; }
            { display: none;  }
         
                </style>
            </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>Introspection Search Usage</title>
      <input type="checkbox" token="Exclutions3" searchWhenChanged="true">
        <label>Exclude GMC Searches</label>
        <choice value="Search_Activity.Introspection_Search_Usage.app3!=&quot;splunk_global_monitoring_console&quot;">Yes</choice>
        <choice value="">No</choice>
        <delimiter/>
        <default>"Search_Activity.Introspection_Search_Usage.app3!=""splunk_global_monitoring_console"""</default>
        <initialValue>Search_Activity.Introspection_Search_Usage.app3!="splunk_global_monitoring_console"</initialValue>
      </input>
      <input type="time" token="IntrospectionTimeRangePkr" searchWhenChanged="true">
        <label>Introspection Time Range</label>
        <default>
          <earliest>-15m</earliest>
          <latest>now</latest>
        </default>
      </input>
      <input type="dropdown" token="search_id_normalized" searchWhenChanged="true">
        <label>Normalized Search ID</label>
        <choice value="*">All</choice>
        <fieldForLabel>search_id_normalized</fieldForLabel>
        <fieldForValue>search_id_normalized</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_introspection_search_usage">
          <query>| stats count by search_id_normalized</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="savedsearch_type" searchWhenChanged="true">
        <label>Savedsearch Type (Report/Alert)</label>
        <choice value="*">All</choice>
        <choice value="alert">Alert</choice>
        <choice value="report">Report</choice>
        <fieldForLabel>savedsearch_type</fieldForLabel>
        <fieldForValue>savedsearch_type</fieldForValue>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Splunk_Roles" searchWhenChanged="true">
        <label>Splunk Roles</label>
        <choice value="*">All</choice>
        <fieldForLabel>Splunk_Roles</fieldForLabel>
        <fieldForValue>Splunk_Roles</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_introspection_search_usage">
          <query>| stats count by Splunk_Roles
| search NOT Splunk_Roles IN (license_master, kv_store, cluster_search_head, cluster_slave, search_peer, deployment_server)</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="host" searchWhenChanged="true">
        <label>Splunk Instance</label>
        <choice value="*">All</choice>
        <fieldForLabel>host</fieldForLabel>
        <fieldForValue>host</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_introspection_search_usage">
          <query>| stats count by host</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="search_type" searchWhenChanged="true">
        <label>Search Type</label>
        <choice value="*">All</choice>
        <choice value="adhoc">Ad-Hoc</choice>
        <choice value="scheduled">Scheduled</choice>
        <choice value="datamodel_acceleration">Datamodel Acceleration</choice>
        <choice value="report_acceleration">Report Acceleration</choice>
        <choice value="summary_indexing">Summary Indexing</choice>
        <fieldForLabel>search_type</fieldForLabel>
        <fieldForValue>search_type</fieldForValue>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="search_head" searchWhenChanged="true">
        <label>Search Head Initiator</label>
        <choice value="*">All</choice>
        <fieldForLabel>search_head</fieldForLabel>
        <fieldForValue>search_head</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_introspection_search_usage">
          <query>| stats count by search_head</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="mode" searchWhenChanged="true">
        <label>Search Mode</label>
        <choice value="*">All</choice>
        <choice value="RT">Real-Time</choice>
        <choice value="RT indexed">Real-Time Indexed</choice>
        <choice value="historical">Historical</choice>
        <choice value="historical batch">Historical Batch</choice>
        <fieldForLabel>mode</fieldForLabel>
        <fieldForValue>mode</fieldForValue>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="savedsearch_name" searchWhenChanged="true">
        <label>Savedsearch Name</label>
        <choice value="*">All</choice>
        <fieldForLabel>savedsearch_name</fieldForLabel>
        <fieldForValue>savedsearch_name</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_introspection_search_usage">
          <query>| stats count by savedsearch_name 
| where ! savedsearch_name LIKE "_ACCELERATE%"</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Provenance_Type" searchWhenChanged="true">
        <label>Provenance</label>
        <choice value="*">All</choice>
        <choice value="UI">User Interface</choice>
        <choice value="scheduler">Scheduler</choice>
        <choice value="summary_director">Report Summarization</choice>
        <choice value="rest">Rest</choice>
        <choice value="splunkjs">Splunkjs</choice>
        <fieldForLabel>Provenance_Type</fieldForLabel>
        <fieldForValue>Provenance_Type</fieldForValue>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Provenance_KO_Type" searchWhenChanged="true">
        <label>Provenance Type</label>
        <choice value="*">All</choice>
        <choice value="Search">Search</choice>
        <choice value="Dashboard">Dashboard</choice>
        <fieldForLabel>Provenance_KO_Type</fieldForLabel>
        <fieldForValue>Provenance_KO_Type</fieldForValue>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Provenance_KO" searchWhenChanged="true">
        <label>Dashboard</label>
        <choice value="*">All</choice>
        <fieldForLabel>Provenance_KO</fieldForLabel>
        <fieldForValue>Provenance_KO</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_introspection_search_usage">
          <query>| stats count by Provenance_KO</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="datamodel" searchWhenChanged="true">
        <label>Datamodel</label>
        <choice value="*">All</choice>
        <fieldForLabel>datamodel</fieldForLabel>
        <fieldForValue>datamodel</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_introspection_search_usage">
          <query>| stats count by datamodel</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Lookup_Reference" searchWhenChanged="true">
        <label>Lookup Reference</label>
        <choice value="*">All</choice>
        <fieldForLabel>Lookup_Reference</fieldForLabel>
        <fieldForValue>Lookup_Reference</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_introspection_search_usage">
          <query>| stats count by Lookup_Reference</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Datamodel_Reference" searchWhenChanged="true">
        <label>Datamodel Reference</label>
        <choice value="*">All</choice>
        <fieldForLabel>Datamodel_Reference</fieldForLabel>
        <fieldForValue>Datamodel_Reference</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_introspection_search_usage">
          <query>| stats count by Datamodel_Reference</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="user" searchWhenChanged="true">
        <label>User</label>
        <choice value="*">All</choice>
        <fieldForLabel>user</fieldForLabel>
        <fieldForValue>user</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_introspection_search_usage">
          <query>| stats count by user</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="app" searchWhenChanged="true">
        <label>App</label>
        <choice value="*">All</choice>
        <fieldForLabel>app</fieldForLabel>
        <fieldForValue>app</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_introspection_search_usage">
          <query>| stats count by app</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Department" searchWhenChanged="true">
        <label>Department</label>
        <choice value="*">All</choice>
        <fieldForLabel>Department</fieldForLabel>
        <fieldForValue>Department</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_introspection_search_usage">
          <query>| stats count by Department</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="LOB" searchWhenChanged="true">
        <label>LOB</label>
        <choice value="*">All</choice>
        <fieldForLabel>LOB</fieldForLabel>
        <fieldForValue>LOB</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_introspection_search_usage">
          <query>| stats count by LOB</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="work_city" searchWhenChanged="true">
        <label>City</label>
        <choice value="*">All</choice>
        <fieldForLabel>work_city</fieldForLabel>
        <fieldForValue>work_city</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_introspection_search_usage">
          <query>| stats count by work_city</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="work_region" searchWhenChanged="true">
        <label>Region/State</label>
        <choice value="*">All</choice>
        <fieldForLabel>work_region</fieldForLabel>
        <fieldForValue>work_region</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_introspection_search_usage">
          <query>| stats count by work_region</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="work_country" searchWhenChanged="true">
        <label>Country</label>
        <choice value="*">All</choice>
        <fieldForLabel>work_country</fieldForLabel>
        <fieldForValue>work_country</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_introspection_search_usage">
          <query>| stats count by work_country</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="mem_used" searchWhenChanged="true">
        <label>Memory Used (&gt;=)</label>
        <default>0</default>
        <initialValue>0</initialValue>
      </input>
      <input type="text" token="pid" searchWhenChanged="true">
        <label>PID</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="search_id2" searchWhenChanged="true">
        <label>Search ID (Contains)</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="Provenance_KO" searchWhenChanged="true">
        <label>Object Name</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="search_id_normalized" searchWhenChanged="true">
        <label>Normalized Search ID (Contains)</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="total_run_time" searchWhenChanged="true">
        <label>Total Run Time in Seconds &gt;</label>
        <default>-1</default>
        <initialValue>-1</initialValue>
      </input>
      <table>
        <title>To Drilldown on a Normalized Search ID to see information on it from _audit &amp; _internal click inside the field value of  the "Normalized Search ID" Field</title>
        <search base="splunk_sh_04_audit_search_activity_dashboard_introspection_search_usage">
          <query>| eval `gmc_time_format(_time)` , `gmc_time_format(Earliest_Access_Updated)` , `gmc_time_format(Latest_Access_Updated)` , `gmc_time_format(Latest_Access_Updated)` , `gmc_time_format(Earliest_Access_Updated)` 
| eval max_spent=max_spent/1000 , physicalMemoryMB=round(physicalMemoryMB / 1024, 2) 
| `gmc_convert_runtime('total_run_time')` 
| convert ctime(startup_time) 
| table search_id_normalized host Splunk_Roles search_head search_type mode Provenance_Type Provenance_KO_Type Provenance_KO app user first last full_name ppid pid savedsearch_name savedsearch_type _time 'total_run_time' total_run_time mem_used physicalMemoryMB normalized_pct_cpu max_hist_searches max_searches_per_cpu numberOfCores base_max_searches numberOfVirtualCores t_count fd_used read_mb written_mb scan_count delta_scan_count max_spent Department Title LOB work_city work_region work_country cron_schedule schedule_priority max_concurrent schedule_window allow_skew realtime_schedule dispatch_earliest_time dispatch_latest_time page_faults provenance run_n_times search_head datamodel Datamodel_Reference Lookup_Reference ulimits_open_files ulimits_stack_size ulimits_user_processes startup_time version max_searches_perc auto_summary_perc max_auto_summary_searches max_hist_scheduled_searches 
| sort 0 - total_run_time 
| `rename_common_fields` 
| rename _time as "Search Time" search_head as "Search Head" pid as PID ppid as PPID provenance as Provenance datamodel as Datamodel dataset as Dataset mem_used as "Memory Used" "pct_memory" as "Memory %" normalized_pct_cpu as "Normalized CPU %" pct_cpu as "CPU %" t_count as "Thread Count" scan_count as "Scan Count" delta_scan_count as "Delta Scan Count" fd_used as "Open Files" page_faults as "Page Faults" read_mb as "Read MB" written_mb as "Written MB" status as Status acceleration_id as "Acceleration ID" app as App mode as "Search Mode" work_city AS City work_region AS Region work_country AS Country numberOfCores AS pCPU numberOfVirtualCores AS vCPU last AS "Last Name" first as "First Name" full_name AS "Full Name" ulimits_open_files AS "Ulimit Open Files" ulimits_stack_size AS "Ulimit Stack Size" ulimits_user_processes AS "Ulimit User Processes" startup_time AS "Splunk Startup Time" version AS "Splunk Version" savedsearch_type AS "Savedsearch Type" physicalMemoryMB AS "Server Memory" Provenance_Type AS Provenance Provenance_KO_Type AS "Provenance Type" Provenance_KO AS Dashboard Datamodel_Reference AS "Datamodel Reference" Lookup_Reference AS "Lookup Reference" dispatch_earliest_time AS "Job Dispatch ET" dispatch_latest_time AS "Job Dispatch LT" cron_schedule AS "Job Cron Schedule" schedule_priority AS "Job Schedule Priority" max_concurrent AS "Job Max Concurrent" schedule_window AS "Job Schedule Window" allow_skew AS "Job Allow Skew" realtime_schedule AS "Job RT Schedule" max_spent AS "Dashboard Load Time" base_max_searches AS "Base Max Searches" max_searches_per_cpu AS "Max Searches Per CPU" max_hist_searches AS "Max Historical Searches" max_searches_perc AS "Max Searches %" auto_summary_perc AS "Auto Summary %" max_auto_summary_searches AS "Max Auto Summary Searches" max_hist_scheduled_searches AS "Max Historical Scheduled Searches" Splunk_Roles AS "Splunk Roles"</query>
        </search>
        <option name="count">5</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="percentagesRow">false</option>
        <option name="refresh.display">none</option>
        <option name="rowNumbers">true</option>
        <option name="totalsRow">false</option>
        <option name="wrap">false</option>
        <format type="color" field="App">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="Runtime_Sec">
          <option name="unit">Seconds</option>
        </format>
        <format type="color" field="Runtime_Sec">
          <colorPalette type="list">[#53A051,#006D9C,#F8BE34,#F1813F,#DC4E41]</colorPalette>
          <scale type="threshold">0,300,600,900</scale>
        </format>
        <format type="number" field="Normalized CPU %">
          <option name="unit">%</option>
        </format>
        <format type="color" field="Normalized CPU %">
          <colorPalette type="list">[#53A051,#006D9C,#F8BE34,#F1813F,#DC4E41]</colorPalette>
          <scale type="threshold">0,30,70,100</scale>
        </format>
        <format type="number" field="Read MB">
          <option name="unit">MB</option>
        </format>
        <format type="number" field="Written MB">
          <option name="unit">MB</option>
        </format>
        <format type="number" field="Thread Count">
          <option name="precision">0</option>
          <option name="unit">Threads</option>
        </format>
        <format type="color" field="Splunk Instance">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Search Head">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Search Type">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Search Mode">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Normalized Search ID">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="User">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="First Name">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Last Name">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Full Name">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="PPID">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="PID">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Savedsearch Name">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Savedsearch Type">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Memory Used">
          <colorPalette type="minMidMax" maxColor="#DC4E41" midColor="#F8BE34" minColor="#53A051"></colorPalette>
          <scale type="minMidMax" midType="percent" midValue="50"></scale>
        </format>
        <format type="number" field="Memory Used">
          <option name="unit">GB</option>
        </format>
        <format type="number" field="Server Memory">
          <option name="unit">GB</option>
        </format>
        <format type="color" field="pCPU">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="vCPU">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Server Memory">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Thread Count">
          <colorPalette type="minMidMax" maxColor="#DC4E41" midColor="#F8BE34" minColor="#53A051"></colorPalette>
          <scale type="minMidMax" midType="percent" midValue="50"></scale>
        </format>
        <format type="color" field="Department">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Title">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="LOB">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="City">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Region">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Country">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Datamodel">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Open Files">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Read MB">
          <colorPalette type="minMidMax" maxColor="#DC4E41" midColor="#F8BE34" minColor="#53A051"></colorPalette>
          <scale type="minMidMax" midType="percent" midValue="50"></scale>
        </format>
        <format type="color" field="Written MB">
          <colorPalette type="minMidMax" maxColor="#DC4E41" midColor="#F8BE34" minColor="#53A051"></colorPalette>
          <scale type="minMidMax" midType="percent" midValue="50"></scale>
        </format>
        <format type="number" field="Scan Count">
          <option name="precision">0</option>
        </format>
        <format type="color" field="Scan Count">
          <colorPalette type="minMidMax" maxColor="#DC4E41" midColor="#F8BE34" minColor="#53A051"></colorPalette>
          <scale type="minMidMax" midType="percent" midValue="50"></scale>
        </format>
        <format type="number" field="Ulimit Open Files">
          <option name="precision">0</option>
        </format>
        <format type="number" field="Ulimit Stack Size">
          <option name="precision">0</option>
        </format>
        <format type="number" field="Ulimit User Processes">
          <option name="precision">0</option>
        </format>
        <format type="color" field="Provenance">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Provenance Type">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Dashboard">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Runtime">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Search Time">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="Delta Scan Count">
          <option name="precision">0</option>
        </format>
        <format type="number" field="Dashboard Load Time">
          <option name="unit">Seconds</option>
        </format>
        <format type="color" field="Job Max Concurrent">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Job Schedule Window">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="Page Faults">
          <option name="precision">0</option>
        </format>
        <format type="color" field="Datamodel Reference">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Lookup Reference">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Max Historical Searches">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="Max Historical Searches">
          <option name="precision">0</option>
        </format>
        <format type="color" field="Max Searches Per CPU">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="Max Searches Per CPU">
          <option name="precision">0</option>
          <option name="unit">Searches</option>
        </format>
        <format type="number" field="pCPU">
          <option name="precision">0</option>
          <option name="unit">pCPU</option>
        </format>
        <format type="color" field="Base Max Searches">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="Base Max Searches">
          <option name="precision">0</option>
          <option name="unit">vCPU</option>
        </format>
        <format type="color" field="Max Searches %">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="Max Searches %">
          <option name="precision">0</option>
          <option name="unit">%</option>
        </format>
        <format type="color" field="Auto Summary %">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="Auto Summary %">
          <option name="precision">0</option>
          <option name="unit">%</option>
        </format>
        <format type="color" field="Max Auto Summary Searches">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="Max Auto Summary Searches">
          <option name="precision">0</option>
        </format>
        <format type="color" field="Max Historical Scheduled Searches">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="Max Historical Scheduled Searches">
          <option name="precision">0</option>
        </format>
        <format type="color" field="Splunk Version">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Ulimit Open Files">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Ulimit User Processes">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Ulimit Stack Size">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Job Cron Schedule">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Job Schedule Priority">
          <colorPalette type="map">{"High":#DC4E41,"default":#006D9C,"Low":#53A051}</colorPalette>
        </format>
        <format type="number" field="Job Allow Skew">
          <option name="precision">0</option>
        </format>
        <format type="color" field="Job Allow Skew">
          <colorPalette type="map">{"0":#DC4E41,"100%":#53A051}</colorPalette>
        </format>
        <format type="color" field="Splunk Roles">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Delta Scan Count">
          <colorPalette type="minMidMax" maxColor="#B6C75A" midColor="#FFFFFF" minColor="#294E70"></colorPalette>
          <scale type="minMidMax" midType="percentile" midValue="50"></scale>
        </format>
        <format type="color" field="Dashboard Load Time">
          <colorPalette type="minMidMax" maxColor="#B6C75A" midColor="#FFFFFF" minColor="#294E70"></colorPalette>
          <scale type="minMidMax" midType="percentile" midValue="50"></scale>
        </format>
        <format type="number" field="Job RT Schedule">
          <option name="precision">0</option>
        </format>
        <format type="color" field="Job RT Schedule">
          <colorPalette type="minMidMax" maxColor="#4FA484" midColor="#FFFFFF" minColor="#F8BE34"></colorPalette>
          <scale type="minMidMax" midType="percentile" midValue="50"></scale>
        </format>
        <format type="color" field="Job Dispatch ET">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Job Dispatch LT">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Page Faults">
          <colorPalette type="minMidMax" maxColor="#5A4575" midColor="#FFFFFF" minColor="#708794"></colorPalette>
          <scale type="minMidMax" midType="percentile" midValue="50"></scale>
        </format>
        <format type="color" field="Splunk Startup Time">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <drilldown>
          <set token="search_id_normalized">$click.value2$</set>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Before you can drildown to look at running jobs, select the host from the dropdown above and then click the link below.   https://$host$:8000/en-US/app/search/job_manager?owner=&amp;app=&amp;jobStatus=running</title>
      <html>
                <a href="https://$host$:8000/en-US/app/search/job_manager?owner=&amp;app=&amp;jobStatus=running" target="_blank">Splunk Job Manager</a>
            </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>Dashboard Drilldown</title>
      <table>
        <search base="splunk_sh_04_audit_search_activity_dashboard_introspection_search_usage">
          <query>| where Provenance_KO!="Undefined" | stats values(Search) AS Search by Provenance_KO
| rename Provenance_KO as "Dashboard Title"
| fields - count</query>
        </search>
        <option name="count">1</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">none</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">false</option>
        <format type="color" field="Dashboard Title">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Search">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <drilldown>
          <link target="_blank">/app/splunk_global_monitoring_console/splunk_sh_06_knowledge_objects_analysis_dashboard_v1?form.title=$click.value2$</link>
        </drilldown>
      </table>
    </panel>
    <panel>
      <title>Report/Alert Drilldown</title>
      <table>
        <search base="splunk_sh_04_audit_search_activity_dashboard_introspection_search_usage">
          <query>| where ! savedsearch_name LIKE "_ACCELERATE%" 
| stats values(Search) AS Search by savedsearch_name 
| rename savedsearch_name as "Report/Alert Name"</query>
        </search>
        <option name="count">1</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">none</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">false</option>
        <format type="color" field="Report/Alert Name">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <drilldown>
          <link target="_blank">/app/splunk_global_monitoring_console/splunk_sh_06_knowledge_objects_analysis_dashboard_v1?form.savedsearch_name=$click.value2$</link>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Audit Search Usage</title>
      <input type="checkbox" token="Exclutions1" searchWhenChanged="true">
        <label>Exclude GMC Searches</label>
        <choice value="NOT Search_Activity.Audit_Search.savedsearch_name1 IN (&quot;*splunk_global_monitoring_console*&quot;, &quot;splunk_*_dashboard_v*&quot;, &quot;splunk_*_*_lookup_*&quot;)">Yes</choice>
        <choice value="">No</choice>
        <delimiter/>
        <default>"NOT Search_Activity.Audit_Search.savedsearch_name1 IN (""*splunk_global_monitoring_console*"", ""splunk_*_dashboard_v*"", ""splunk_*_*_lookup_*"")"</default>
        <initialValue>NOT Search_Activity.Audit_Search.savedsearch_name1 IN ("*splunk_global_monitoring_console*", "splunk_*_dashboard_v*", "splunk_*_*_lookup_*")</initialValue>
      </input>
      <input type="time" token="AuditTimeRangePkr" searchWhenChanged="true">
        <label>Audit Time Range</label>
        <default>
          <earliest>-15m</earliest>
          <latest>now</latest>
        </default>
      </input>
      <input type="dropdown" token="search_id_normalized" searchWhenChanged="true">
        <label>Normalized Search ID</label>
        <choice value="*">All</choice>
        <fieldForLabel>search_id_normalized</fieldForLabel>
        <fieldForValue>search_id_normalized</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_audit_search">
          <query>| stats count by search_id_normalized</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Splunk_Roles" searchWhenChanged="true">
        <label>Splunk Roles</label>
        <choice value="*">All</choice>
        <fieldForLabel>Splunk_Roles</fieldForLabel>
        <fieldForValue>Splunk_Roles</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_audit_search">
          <query>| stats count by Splunk_Roles</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="host" searchWhenChanged="true">
        <label>Splunk Instance</label>
        <choice value="*">All</choice>
        <fieldForLabel>host</fieldForLabel>
        <fieldForValue>host</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_audit_search">
          <query>| stats count by host</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="search_type" searchWhenChanged="true">
        <label>Search Type</label>
        <choice value="*">All</choice>
        <choice value="adhoc">Ad-Hoc</choice>
        <choice value="scheduled">Scheduled Reports/Alerts</choice>
        <choice value="datamodel_acceleration">Datamodel Acceleration</choice>
        <choice value="report_acceleration">Report Acceleration</choice>
        <choice value="summary_indexing">Summary Indexing</choice>
        <choice value="realtime">Realtime</choice>
        <choice value="subsearch">Subsearch</choice>
        <choice value="typeahead">Typeahead</choice>
        <fieldForLabel>search_type</fieldForLabel>
        <fieldForValue>search_type</fieldForValue>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="info" searchWhenChanged="true">
        <label>Search Info</label>
        <choice value="*">All</choice>
        <choice value="granted">Granted</choice>
        <choice value="completed">Completed</choice>
        <choice value="canceled">Canceled</choice>
        <choice value="failed">Failed</choice>
        <fieldForLabel>info</fieldForLabel>
        <fieldForValue>info</fieldForValue>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="savedsearch_name" searchWhenChanged="true">
        <label>Savedsearch Name</label>
        <choice value="*">All</choice>
        <fieldForLabel>savedsearch_name</fieldForLabel>
        <fieldForValue>savedsearch_name</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_audit_search">
          <query>| stats count by savedsearch_name 
| where savedsearch_name!="N/A" AND ! savedsearch_name LIKE "_ACCELERATE%"</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="search_class" searchWhenChanged="true">
        <label>Search Class</label>
        <choice value="*">All</choice>
        <fieldForLabel>search_class</fieldForLabel>
        <fieldForValue>search_class</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_audit_search">
          <query>| stats count by search_class</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Index_Name" searchWhenChanged="true">
        <label>Indexes Searched</label>
        <choice value="*">All</choice>
        <fieldForLabel>Index_Name</fieldForLabel>
        <fieldForValue>Index_Name</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_audit_search">
          <query>| stats count by "Index_Name"</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Source_Type" searchWhenChanged="true">
        <label>Sourcetypes Searched</label>
        <choice value="*">All</choice>
        <fieldForLabel>Source_Type</fieldForLabel>
        <fieldForValue>Source_Type</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_audit_search">
          <query>| stats count by Source_Type</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="savedsearch_type" searchWhenChanged="true">
        <label>Savedsearch Type (Report/Alert)</label>
        <choice value="*">All</choice>
        <choice value="alert">Alert</choice>
        <choice value="report">Report</choice>
        <fieldForLabel>savedsearch_type</fieldForLabel>
        <fieldForValue>savedsearch_type</fieldForValue>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="datamodel" searchWhenChanged="true">
        <label>Datamodel</label>
        <choice value="*">All</choice>
        <fieldForLabel>datamodel</fieldForLabel>
        <fieldForValue>datamodel</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_audit_search">
          <query>| stats count by datamodel</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="dataset" searchWhenChanged="true">
        <label>Dataset</label>
        <choice value="*">All</choice>
        <fieldForLabel>dataset</fieldForLabel>
        <fieldForValue>dataset</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_audit_search">
          <query>| stats count by dataset</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Lookup_Reference" searchWhenChanged="true">
        <label>Lookup Reference</label>
        <choice value="*">All</choice>
        <fieldForLabel>Lookup_Reference</fieldForLabel>
        <fieldForValue>Lookup_Reference</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_audit_search">
          <query>| stats count by Lookup_Reference</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="user" searchWhenChanged="true">
        <label>User</label>
        <choice value="*">All</choice>
        <fieldForLabel>user</fieldForLabel>
        <fieldForValue>user</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_audit_search">
          <query>| stats count by user</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="LOB" searchWhenChanged="true">
        <label>LOB</label>
        <choice value="*">All</choice>
        <fieldForLabel>LOB</fieldForLabel>
        <fieldForValue>LOB</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_audit_search">
          <query>| stats count by LOB</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Department" searchWhenChanged="true">
        <label>Department</label>
        <choice value="*">All</choice>
        <fieldForLabel>Department</fieldForLabel>
        <fieldForValue>Department</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_audit_search">
          <query>| stats count by Department</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="work_city" searchWhenChanged="true">
        <label>City</label>
        <choice value="*">All</choice>
        <fieldForLabel>work_city</fieldForLabel>
        <fieldForValue>work_city</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_audit_search">
          <query>| stats count by work_city</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="work_region" searchWhenChanged="true">
        <label>Region/State</label>
        <choice value="*">All</choice>
        <fieldForLabel>work_region</fieldForLabel>
        <fieldForValue>work_region</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_audit_search">
          <query>| stats count by work_region</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="work_country" searchWhenChanged="true">
        <label>Country</label>
        <choice value="*">All</choice>
        <fieldForLabel>work_country</fieldForLabel>
        <fieldForValue>work_country</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_audit_search">
          <query>| stats count by work_country</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="searched_buckets" searchWhenChanged="true">
        <label>Number Searched Buckets &gt;</label>
        <default>-1</default>
        <initialValue>-1</initialValue>
      </input>
      <input type="text" token="search_size" searchWhenChanged="true">
        <label>Search Size</label>
        <default>-1</default>
        <initialValue>-1</initialValue>
      </input>
      <input type="text" token="search" searchWhenChanged="true">
        <label>Search</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="total_run_time" searchWhenChanged="true">
        <label>Total Run Time in Seconds &gt;</label>
        <default>-1</default>
        <initialValue>-1</initialValue>
      </input>
      <input type="text" token="search_id_normalized" searchWhenChanged="true">
        <label>Normalized Search ID (Contains)</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <table>
        <title>List of searches matching the above filter</title>
        <search base="splunk_sh_04_audit_search_activity_dashboard_audit_search">
          <query>| eval `gmc_time_format(search_lt)` , `gmc_time_format(search_et)` , `gmc_time_format(dispatch_time)` , `gmc_time_format(_time)` , `gmc_time_format(exec_time)` 
| sort 0 - total_run_time 
| `gmc_convert_runtime('total_run_time')` 
| table Splunk_Roles host search_type info search_id_normalized savedsearch_name savedsearch_type dispatch_time total_run_time 'total_run_time' _time search_et search_lt user first last full_name Department LOB Title Author_Roles work_city work_region work_country datamodel dataset scan_count event_count result_count available_count considered_events searched_buckets total_slices decompressed_slices search_size cron_schedule schedule_priority max_concurrent schedule_window allow_skew realtime_schedule  
| `rename_common_fields` 
| rename _time as "Completion Time (_time)" , datamodel as Datamodel , dataset as Dataset , scan_count as "Scan Count" , search_et AS "Search ET" , search_lt as "Search LT" , dispatch_time as "Dispatch Time" , event_count as "Event Count" , result_count as "Result Count" , available_count as "Available Count" , considered_events as "Considered Events" , searched_buckets as "Searched Buckets" , total_slices as "Total Slices" , decompressed_slices as "Decompressed Slices" , search_startup_time as "Search Startup Time" , search_size as "Search Size" , search as Search , exec_time as "Execution Time" , savedsearch_type AS "Savedsearch Type"</query>
        </search>
        <option name="count">5</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="percentagesRow">false</option>
        <option name="refresh.display">none</option>
        <option name="rowNumbers">true</option>
        <option name="totalsRow">false</option>
        <option name="wrap">false</option>
        <format type="color" field="Host">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Savedsearch Name">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Normalized Search ID">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Info">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="User">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Worker_Status">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Department">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Name">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Worker_Type">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Title">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="LOB">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="work_city">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="work_region">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="work_country">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Search Type">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Datamodel">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Dataset">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="Scan Count">
          <option name="precision">0</option>
        </format>
        <format type="number" field="Event Count"></format>
        <format type="number" field="Result Count">
          <option name="precision">0</option>
        </format>
        <format type="number" field="Considered Events">
          <option name="precision">0</option>
        </format>
        <format type="number" field="Available Count">
          <option name="precision">0</option>
        </format>
        <format type="number" field="Total Slices">
          <option name="precision">0</option>
        </format>
        <format type="number" field="Decompressed Slices">
          <option name="precision">0</option>
        </format>
        <format type="color" field="Search">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Runtime_Sec">
          <colorPalette type="list">[#53A051,#006D9C,#F8BE34,#F1813F,#DC4E41]</colorPalette>
          <scale type="threshold">0,300,600,900</scale>
        </format>
        <format type="number" field="Runtime_Sec">
          <option name="unit">s</option>
        </format>
        <format type="number" field="Searched Buckets">
          <option name="precision">0</option>
          <option name="unit">Buckets</option>
        </format>
        <format type="color" field="Savedsearch Type">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Splunk_Roles">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="Search Size">
          <option name="unit">Bytes</option>
        </format>
        <format type="color" field="Splunk Instance">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
      </table>
      <viz type="number_display_viz.number_display_viz">
        <title>Search Types</title>
        <search base="splunk_sh_04_audit_search_activity_dashboard_audit_search">
          <query>| where info!="granted" 
| eval search_type=case(search_type="adhoc", "Ad-Hoc", search_type="scheduled", "Scheduled Reports/Alerts", search_type="datamodel_acceleration", "Datamodel Acceleration", search_type="report_acceleration", "Report Acceleration", search_type="summary_indexing", "Summary Indexing", search_type="realtime", "Realtime", search_type="subsearch", "Subsearch", search_type="typeahead", "Typeahead", true(), search_type)
| stats count by search_type</query>
        </search>
        <option name="height">600</option>
        <option name="number_display_viz.number_display_viz.bordercolor">#FFFFFF</option>
        <option name="number_display_viz.number_display_viz.bordersize">2</option>
        <option name="number_display_viz.number_display_viz.colorprimary">#ebb839</option>
        <option name="number_display_viz.number_display_viz.colorprimarymode">auto</option>
        <option name="number_display_viz.number_display_viz.colorsecondary">#1a9035</option>
        <option name="number_display_viz.number_display_viz.colorsecondarymode">static</option>
        <option name="number_display_viz.number_display_viz.max">100</option>
        <option name="number_display_viz.number_display_viz.min">0</option>
        <option name="number_display_viz.number_display_viz.nodatacolor">#0178c7</option>
        <option name="number_display_viz.number_display_viz.padding">10</option>
        <option name="number_display_viz.number_display_viz.pulserate">4</option>
        <option name="number_display_viz.number_display_viz.shadowcolor">#F2F4F5</option>
        <option name="number_display_viz.number_display_viz.shapebordercolor">#FFFFFF</option>
        <option name="number_display_viz.number_display_viz.shapebordercolormode">static</option>
        <option name="number_display_viz.number_display_viz.shapebordersize">1</option>
        <option name="number_display_viz.number_display_viz.shapedropcolor">#ffffff</option>
        <option name="number_display_viz.number_display_viz.shapeshadow">yes</option>
        <option name="number_display_viz.number_display_viz.shapetexture">solid</option>
        <option name="number_display_viz.number_display_viz.size">300</option>
        <option name="number_display_viz.number_display_viz.sparkHeight">30</option>
        <option name="number_display_viz.number_display_viz.sparkWidth">90</option>
        <option name="number_display_viz.number_display_viz.sparkalign">5</option>
        <option name="number_display_viz.number_display_viz.sparkalignv">70</option>
        <option name="number_display_viz.number_display_viz.sparkcolorfill">#009DD9</option>
        <option name="number_display_viz.number_display_viz.sparkcolorline">#0178c7</option>
        <option name="number_display_viz.number_display_viz.sparkcolormodefill">auto</option>
        <option name="number_display_viz.number_display_viz.sparkcolormodeline">auto</option>
        <option name="number_display_viz.number_display_viz.sparkmin">0</option>
        <option name="number_display_viz.number_display_viz.sparknulls">span</option>
        <option name="number_display_viz.number_display_viz.sparkorder">no</option>
        <option name="number_display_viz.number_display_viz.sparkstyle">line</option>
        <option name="number_display_viz.number_display_viz.spinnerspeedmax">25</option>
        <option name="number_display_viz.number_display_viz.spinnerspeedmin">0</option>
        <option name="number_display_viz.number_display_viz.style">s1</option>
        <option name="number_display_viz.number_display_viz.subtitlealign">center</option>
        <option name="number_display_viz.number_display_viz.subtitlealignv">70</option>
        <option name="number_display_viz.number_display_viz.subtitlecolor">#5C6773</option>
        <option name="number_display_viz.number_display_viz.subtitlecolormode">static</option>
        <option name="number_display_viz.number_display_viz.subtitledrop">yes</option>
        <option name="number_display_viz.number_display_viz.subtitledropcolor">#ffffff</option>
        <option name="number_display_viz.number_display_viz.subtitlesize">40</option>
        <option name="number_display_viz.number_display_viz.textalign">center</option>
        <option name="number_display_viz.number_display_viz.textalignv">50</option>
        <option name="number_display_viz.number_display_viz.textcolor">#000000</option>
        <option name="number_display_viz.number_display_viz.textdrop">yes</option>
        <option name="number_display_viz.number_display_viz.textdropcolor">#ffffff</option>
        <option name="number_display_viz.number_display_viz.textduration">300</option>
        <option name="number_display_viz.number_display_viz.textmode">darker1</option>
        <option name="number_display_viz.number_display_viz.textprecision">1</option>
        <option name="number_display_viz.number_display_viz.textprocessing">abr3</option>
        <option name="number_display_viz.number_display_viz.textsize">100</option>
        <option name="number_display_viz.number_display_viz.textunitposition">after</option>
        <option name="number_display_viz.number_display_viz.textunitsize">50</option>
        <option name="number_display_viz.number_display_viz.thickness">50</option>
        <option name="number_display_viz.number_display_viz.thresholdcol1">#1a9035</option>
        <option name="number_display_viz.number_display_viz.thresholdcol2">#006d9c</option>
        <option name="number_display_viz.number_display_viz.thresholdcol3">#edd051</option>
        <option name="number_display_viz.number_display_viz.thresholdcol4">#ecbc1b</option>
        <option name="number_display_viz.number_display_viz.thresholdcol5">#AF5300</option>
        <option name="number_display_viz.number_display_viz.thresholdcol6">#b22b32</option>
        <option name="number_display_viz.number_display_viz.thresholdsize">20</option>
        <option name="number_display_viz.number_display_viz.thresholdval2">1000</option>
        <option name="number_display_viz.number_display_viz.thresholdval3">5000</option>
        <option name="number_display_viz.number_display_viz.thresholdval4">10000</option>
        <option name="number_display_viz.number_display_viz.thresholdval5">20000</option>
        <option name="number_display_viz.number_display_viz.thresholdval6">40000</option>
        <option name="number_display_viz.number_display_viz.titlealign">center</option>
        <option name="number_display_viz.number_display_viz.titlealignv">30</option>
        <option name="number_display_viz.number_display_viz.titlecolor">#5C6773</option>
        <option name="number_display_viz.number_display_viz.titlecolormode">lighter1</option>
        <option name="number_display_viz.number_display_viz.titledrop">no</option>
        <option name="number_display_viz.number_display_viz.titledropcolor">#ffffff</option>
        <option name="number_display_viz.number_display_viz.titlesize">30</option>
        <option name="refresh.display">progressbar</option>
      </viz>
    </panel>
  </row>
  <row>
    <panel>
      <title>Search Code</title>
      <table>
        <search base="splunk_sh_04_audit_search_activity_dashboard_audit_search">
          <query>| eval search_org=search 
| rex field=search mode=sed "s/^search\s//g"
| rex field=search mode=sed "s/\n//g"
| rex field=search mode=sed "s/^\s|^\"//g" 
| rex field=search mode=sed "s/\s{2,}/ /g" 
| rex field=search mode=sed "s/\n//g"
| rex field=search mode=sed "s/\|/\n|/g"
| rex field=search mode=sed "s/\|\s*/| /g" 
| stats count by search 
| rename search as Search
| where Search!="Undefined"</query>
        </search>
        <option name="count">1</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">none</option>
        <option name="wrap">false</option>
        <format type="color" field="Search">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Internal Scheduler Usage</title>
      <input type="checkbox" token="Exclutions2" searchWhenChanged="true">
        <label>Exclude GMC Searches</label>
        <choice value="Search_Activity.Internal_Scheduler.app2!=&quot;splunk_global_monitoring_console&quot;">Yes</choice>
        <choice value="Search_Activity.Internal_Scheduler.app2=&quot;*&quot;">No</choice>
        <delimiter/>
        <default>"Search_Activity.Internal_Scheduler.app2!=""splunk_global_monitoring_console"""</default>
        <initialValue>Search_Activity.Internal_Scheduler.app2!="splunk_global_monitoring_console"</initialValue>
      </input>
      <input type="time" token="InternalTimeRangePkr" searchWhenChanged="true">
        <label>Internal Time Range</label>
        <default>
          <earliest>-15m</earliest>
          <latest>now</latest>
        </default>
      </input>
      <input type="dropdown" token="search_id_normalized" searchWhenChanged="true">
        <label>Normalized Search ID</label>
        <choice value="*">All</choice>
        <fieldForLabel>search_id_normalized</fieldForLabel>
        <fieldForValue>search_id_normalized</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_internal_scheduler">
          <query>| stats count by search_id_normalized</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Splunk_Roles" searchWhenChanged="true">
        <label>Splunk Roles</label>
        <choice value="*">All</choice>
        <fieldForLabel>Splunk_Roles</fieldForLabel>
        <fieldForValue>Splunk_Roles</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_internal_scheduler">
          <query>| stats count by Splunk_Roles</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="host" searchWhenChanged="true">
        <label>Splunk Instance</label>
        <choice value="*">All</choice>
        <fieldForLabel>host</fieldForLabel>
        <fieldForValue>host</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_internal_scheduler">
          <query>| stats count by host</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="app" searchWhenChanged="true">
        <label>App</label>
        <choice value="*">All</choice>
        <fieldForLabel>app</fieldForLabel>
        <fieldForValue>app</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_internal_scheduler">
          <query>| stats count by app</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="search_type" searchWhenChanged="true">
        <label>Search Type</label>
        <choice value="*">All</choice>
        <choice value="datamodel_acceleration">Datamodel Acceleration</choice>
        <choice value="report_acceleration">Report Acceleration</choice>
        <choice value="scheduled">Scheduled</choice>
        <choice value="summary_indexing">Summary Indexing</choice>
        <fieldForLabel>search_type</fieldForLabel>
        <fieldForValue>search_type</fieldForValue>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="info" searchWhenChanged="true">
        <label>Search Info</label>
        <choice value="*">All</choice>
        <choice value="completed">Completed</choice>
        <choice value="deferred">Deferred</choice>
        <choice value="delegated_remote">Delegated Remote</choice>
        <choice value="delegated_remote_completion">Delegated Remote Completion</choice>
        <choice value="delegated_remote_error">Delegated Remote Error</choice>
        <choice value="skipped">Skipped</choice>
        <fieldForLabel>info</fieldForLabel>
        <fieldForValue>info</fieldForValue>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="savedsearch_name" searchWhenChanged="true">
        <label>Savedsearch Name</label>
        <choice value="*">All</choice>
        <fieldForLabel>savedsearch_name</fieldForLabel>
        <fieldForValue>savedsearch_name</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_internal_scheduler">
          <query>| stats count by savedsearch_name</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="savedsearch_type" searchWhenChanged="true">
        <label>Savedsearch Type (Report/Alert)</label>
        <choice value="*">All</choice>
        <choice value="alert">Alert</choice>
        <choice value="report">Report</choice>
        <fieldForLabel>savedsearch_type</fieldForLabel>
        <fieldForValue>savedsearch_type</fieldForValue>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="priority" searchWhenChanged="true">
        <label>Schedule Priority</label>
        <choice value="*">All</choice>
        <choice value="default">Default</choice>
        <choice value="higher">higher</choice>
        <choice value="highest">highest</choice>
        <fieldForLabel>priority</fieldForLabel>
        <fieldForValue>priority</fieldForValue>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="window_time" searchWhenChanged="true">
        <label>Schedule Window</label>
        <choice value="*">All</choice>
        <fieldForLabel>window_time</fieldForLabel>
        <fieldForValue>window_time</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_internal_scheduler">
          <query>| stats count by window_time</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="allow_skew" searchWhenChanged="true">
        <label>Allow Skew</label>
        <choice value="*">All</choice>
        <fieldForLabel>allow_skew</fieldForLabel>
        <fieldForValue>allow_skew</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_internal_scheduler">
          <query>| stats count by allow_skew</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="concurrency_category" searchWhenChanged="true">
        <label>Concurrency Category</label>
        <choice value="*">All</choice>
        <fieldForLabel>concurrency_category</fieldForLabel>
        <fieldForValue>concurrency_category</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_internal_scheduler">
          <query>| stats count by concurrency_category</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="concurrency_context" searchWhenChanged="true">
        <label>Concurrency Context</label>
        <choice value="*">All</choice>
        <fieldForLabel>concurrency_context</fieldForLabel>
        <fieldForValue>concurrency_context</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_internal_scheduler">
          <query>| stats count by concurrency_context</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="concurrency_limit" searchWhenChanged="true">
        <label>Concurrency Limit</label>
        <choice value="*">All</choice>
        <fieldForLabel>concurrency_limit</fieldForLabel>
        <fieldForValue>concurrency_limit</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_internal_scheduler">
          <query>| stats count by concurrency_limit</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="reason" searchWhenChanged="true">
        <label>Skip Reason</label>
        <choice value="*">All</choice>
        <fieldForLabel>reason</fieldForLabel>
        <fieldForValue>reason</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_internal_scheduler">
          <query>| stats count by reason</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="user" searchWhenChanged="true">
        <label>User</label>
        <choice value="*">All</choice>
        <fieldForLabel>user</fieldForLabel>
        <fieldForValue>user</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_internal_scheduler">
          <query>| stats count by user</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="datamodel" searchWhenChanged="true">
        <label>Datamodel</label>
        <choice value="*">All</choice>
        <fieldForLabel>datamodel</fieldForLabel>
        <fieldForValue>datamodel</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_internal_scheduler">
          <query>| stats count by datamodel</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="LOB" searchWhenChanged="true">
        <label>LOB</label>
        <choice value="*">All</choice>
        <fieldForLabel>LOB</fieldForLabel>
        <fieldForValue>LOB</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_internal_scheduler">
          <query>| stats count by LOB</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Department" searchWhenChanged="true">
        <label>Department</label>
        <choice value="*">All</choice>
        <fieldForLabel>Department</fieldForLabel>
        <fieldForValue>Department</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_internal_scheduler">
          <query>| stats count by Department</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="work_city" searchWhenChanged="true">
        <label>City</label>
        <choice value="*">All</choice>
        <fieldForLabel>work_city</fieldForLabel>
        <fieldForValue>work_city</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_internal_scheduler">
          <query>| stats count by work_city</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="work_region" searchWhenChanged="true">
        <label>Region/State</label>
        <choice value="*">All</choice>
        <fieldForLabel>work_region</fieldForLabel>
        <fieldForValue>work_region</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_internal_scheduler">
          <query>| stats count by work_region</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="work_country" searchWhenChanged="true">
        <label>Country</label>
        <choice value="*">All</choice>
        <fieldForLabel>work_country</fieldForLabel>
        <fieldForValue>work_country</fieldForValue>
        <search base="splunk_sh_04_audit_search_activity_dashboard_internal_scheduler">
          <query>| stats count by work_country</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="search_id_normalized" searchWhenChanged="true">
        <label>Normalized Search ID (Contains)</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="total_run_time" searchWhenChanged="true">
        <label>Total Run Time in Seconds &gt;</label>
        <default>-1</default>
        <initialValue>-1</initialValue>
      </input>
      <table>
        <title>List of searches matching the above filter</title>
        <search base="splunk_sh_04_audit_search_activity_dashboard_internal_scheduler">
          <query>| eval `gmc_time_format(scheduled_time)` , `gmc_time_format(dispatch_time)` , `gmc_time_format(_time)` 
| `gmc_convert_runtime('total_run_time')` 
| table Splunk_Roles host search_type info search_id_normalized savedsearch_name _time cron_schedule schedule_priority max_concurrent schedule_window allow_skew realtime_schedule scheduled_time dispatch_time total_run_time 'total_run_time' app user Department LOB work_city work_region work_country datamodel priority window_time result_count concurrency_category concurrency_context concurrency_limit skipped_count reason alert_actions  
| `rename_common_fields` 
| rename priority AS "Schedule Priority" , window_time AS "Schedule Window" , _time as "Search Time" , datamodel as Datamodel , dataset as Dataset , dispatch_time as "Dispatch Time" , result_count as "Result Count" , app as App , concurrency_category as "Concurrency Category" , concurrency_context as "Concurrency Context" , concurrency_limit as "Concurrency Limit" , skipped_count as "Skipped Count" , reason as Reason , alert_actions as "Alert Actions"</query>
        </search>
        <option name="count">5</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="percentagesRow">false</option>
        <option name="refresh.display">none</option>
        <option name="rowNumbers">true</option>
        <option name="totalsRow">false</option>
        <option name="wrap">false</option>
        <format type="color" field="Host">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Savedsearch Name">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Normalized Search ID">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Info">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Runtime_Sec">
          <colorPalette type="list">[#53A051,#006D9C,#F8BE34,#F1813F,#DC4E41]</colorPalette>
          <scale type="threshold">0,300,600,900</scale>
        </format>
        <format type="number" field="Runtime_Sec">
          <option name="unit">s</option>
        </format>
        <format type="color" field="App">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="User">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Search Type">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Schedule Priority">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Schedule Window">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="Result Count">
          <option name="precision">0</option>
        </format>
        <format type="color" field="Concurrency Category">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Concurrency Context">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="Concurrency Limit">
          <option name="precision">0</option>
        </format>
        <format type="number" field="Skipped Count">
          <option name="precision">0</option>
        </format>
        <format type="color" field="Reason">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Alert Actions">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Splunk_Roles">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Splunk Instance">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Total &amp; Skipped Executions</title>
      <table>
        <search>
          <query>| tstats SUMMARIESONLY=TRUE ALLOW_OLD_SUMMARIES=FALSE 
    sum(Search_Activity.Internal_Scheduler.is_Internal_Total_Executions) as Total_Executions
    sum(Search_Activity.Internal_Scheduler.is_Internal_Skipped_Executions) as Skipped_Executions
    FROM DATAMODEL=GMC
    WHERE nodename=Search_Activity.Internal_Scheduler
    index=_internal
    AND Search_Activity.Internal_Scheduler.savedsearch_name2 = "$savedsearch_name$"
    AND Search_Activity.Internal_Scheduler.app2 = "$app$"
    AND Search_Activity.Internal_Scheduler.search_type2 = "$search_type$" 
    AND Search_Activity.Internal_Scheduler.info2 = "$info$"
    AND Search_Activity.Internal_Scheduler.user2 = "$user$"
    AND host = "$host$"
    Search_Activity.Internal_Scheduler.info2 IN ( "completed" , "skipped")
    BY host 
| `gmc_drop_dm_object_name(Search_Activity.Internal_Scheduler)` 
| rename info2 AS info , host AS Instance 
| `get_instance_info(Instance)` 
| where Splunk_Roles="search_head" 
| eval Skip_Ratio = ( (Skipped_Executions / Total_Executions) * 100), Skip_Ratio = round (Skip_Ratio, 2) 
| table Splunk_Roles Instance Total_Executions Skipped_Executions Skip_Ratio 
| search Splunk_Roles = "$Splunk_Roles$"
| sort 0 - Skip_Ratio</query>
          <earliest>$InternalTimeRangePkr.earliest$</earliest>
          <latest>$InternalTimeRangePkr.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">false</option>
        <format type="color" field="Instance">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="Total_Executions">
          <option name="precision">0</option>
        </format>
        <format type="number" field="Skipped_Executions">
          <option name="precision">0</option>
        </format>
        <format type="number" field="Skip_Ratio">
          <option name="unit">%</option>
        </format>
        <format type="color" field="Total_Executions">
          <colorPalette type="minMidMax" maxColor="#AF575A" midColor="#F8BE34" minColor="#53A051"></colorPalette>
          <scale type="minMidMax" midType="percent" midValue="50"></scale>
        </format>
        <format type="color" field="Skipped_Executions">
          <colorPalette type="list">[#53A051,#F1813F,#DC4E41]</colorPalette>
          <scale type="threshold">15,25</scale>
        </format>
        <format type="color" field="Skip_Ratio">
          <colorPalette type="list">[#53A051,#F1813F,#DC4E41]</colorPalette>
          <scale type="threshold">15,25</scale>
        </format>
        <format type="color" field="Splunk_Roles">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
      </table>
    </panel>
  </row>
</form>