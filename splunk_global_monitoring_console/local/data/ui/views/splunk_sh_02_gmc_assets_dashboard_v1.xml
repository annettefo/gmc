<form theme="dark">
  <label>Splunk - SH - 02 - GMC Assets - Dashboard - v1</label>
  <description>List of all Splunk Servers in the enviroment by Splunk Role with filters</description>
  <search id="splunk_sh_02_gmc_assets_dashboard_v1">
    <query>| inputlookup splunk_rest_server_info_all_csv_lookup
    | makemv delim="|" Splunk_Roles
| fields Splunk_Instance Splunk_Roles serverName host host_fqdn host_resolved mode guid version build os_name os_name_extended cpu_arch os_version os_build startup_time cluster_label kvStoreStatus numberOfCores numberOfVirtualCores physicalMemoryMB rtsearch_enabled master_uri master_guid licenseState isForwarding isTrial license_labels transparent_hugepages_defrag transparent_hugepages_effective_state transparent_hugepages_enabled ulimits_core_file_size ulimits_cpu_time ulimits_data_file_size ulimits_data_segment_size ulimits_nice ulimits_open_files ulimits_resident_memory_size ulimits_stack_size ulimits_user_processes ulimits_virtual_address_space_size
| search Splunk_Instance="*$Splunk_Instance$*" Splunk_Roles="*$Splunk_Roles$*" os_name="$os_name$" version="$version$" isForwarding="$isForwarding$"
      </query>
  </search>
  <fieldset submitButton="false" autoRun="true">
    <input type="dropdown" token="Splunk_Roles" searchWhenChanged="true">
      <label>Splunk Roles</label>
      <fieldForLabel>Splunk_Roles</fieldForLabel>
      <fieldForValue>Splunk_Roles</fieldForValue>
      <search base="splunk_sh_02_gmc_assets_dashboard_v1">
        <query>| stats count by Splunk_Roles</query>
      </search>
      <choice value="*">All</choice>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
    <input type="text" token="Splunk_Roles" searchWhenChanged="true">
      <label>Splunk Roles (Contains)</label>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
    <input type="dropdown" token="Splunk_Instance" searchWhenChanged="true">
      <label>Splunk Instance</label>
      <fieldForLabel>Splunk_Instance</fieldForLabel>
      <fieldForValue>Splunk_Instance</fieldForValue>
      <search base="splunk_sh_02_gmc_assets_dashboard_v1">
        <query>| stats count by Splunk_Instance</query>
      </search>
      <choice value="*">All</choice>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
    <input type="text" token="Splunk_Instance" searchWhenChanged="true">
      <label>Splunk_Instance name (Contains)</label>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
    <input type="dropdown" token="version" searchWhenChanged="true">
      <label>Splunk Version</label>
      <fieldForLabel>version</fieldForLabel>
      <fieldForValue>version</fieldForValue>
      <search base="splunk_sh_02_gmc_assets_dashboard_v1">
        <query>| stats count by version</query>
      </search>
      <choice value="*">All</choice>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
    <input type="dropdown" token="os_name" searchWhenChanged="true">
      <label>Operating System</label>
      <fieldForLabel>os_name</fieldForLabel>
      <fieldForValue>os_name</fieldForValue>
      <search base="splunk_sh_02_gmc_assets_dashboard_v1">
        <query>| stats count by os_name</query>
      </search>
      <choice value="*">All</choice>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
    <input type="dropdown" token="isForwarding" searchWhenChanged="true">
      <label>isForwarding</label>
      <fieldForLabel>isForwarding</fieldForLabel>
      <fieldForValue>isForwarding</fieldForValue>
      <choice value="*">All</choice>
      <choice value="1">Yes</choice>
      <choice value="0">No</choice>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
  </fieldset>
  <row id="style_settings" depends="$visible$">
    <panel depends="$alwaysHideCSS$">
      <html>
                <style>
                    <!--.dashboard-body {-->
                    <!--    background: #a6a6a6 !important;-->
                    <!--}-->
           .dashboard-panel h2{
             background:#FFA500 !important;
             color:black !important;
             text-align: center !important;
             font-weight: bold !important;
             border-top-right-radius: 15px;
             border-top-left-radius: 15px; }
            .dashboard-panel h1.panel-title {
              font-weight: bold !important;
              font-size: 100% !important; }
                .table, th, td {
              border: 8px solid black !important; }
            { display: none;  }
         
                </style>
            </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>Number of Splunk Instances</title>
      <single>
        <search base="splunk_sh_02_gmc_assets_dashboard_v1">
          <query>| stats count</query>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">all</option>
        <option name="rangeColors">["0x53a051","0x006d9c"]</option>
        <option name="rangeValues">[0]</option>
        <option name="refresh.display">none</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Instances By Splunk Version</title>
      <chart>
        <search base="splunk_sh_02_gmc_assets_dashboard_v1">
          <query>| stats count by version</query>
        </search>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.sliceCollapsingThreshold">0</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">none</option>
      </chart>
    </panel>
    <panel>
      <title>Instances By OS</title>
      <table>
        <search base="splunk_sh_02_gmc_assets_dashboard_v1">
          <query>| stats count AS "# of Instances" by os_name
| rename os_name AS OS</query>
        </search>
        <option name="count">4</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">false</option>
        <format type="color" field="OS">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Splunk Instance Information</title>
      <table>
        <search base="splunk_sh_02_gmc_assets_dashboard_v1">
          <query>| convert ctime(startup_time) 
| fields Splunk_Instance Splunk_Roles serverName host host_fqdn host_resolved version numberOfCores numberOfVirtualCores physicalMemoryMB mode guid build os_name os_name_extended cpu_arch os_version os_build startup_time cluster_label kvStoreStatus rtsearch_enabled master_uri master_guid licenseState isForwarding isTrial license_labels transparent_hugepages_effective_state transparent_hugepages_enabled transparent_hugepages_defrag ulimits_core_file_size ulimits_cpu_time ulimits_data_file_size ulimits_data_segment_size ulimits_nice ulimits_open_files ulimits_resident_memory_size ulimits_stack_size ulimits_user_processes ulimits_virtual_address_space_size 
| eval Memory = round(physicalMemoryMB / 1024, 2) 
| table Splunk_Instance Splunk_Roles version numberOfCores numberOfVirtualCores Memory os_name os_version startup_time isForwarding ulimits_open_files ulimits_stack_size ulimits_user_processes transparent_hugepages_defrag transparent_hugepages_effective_state transparent_hugepages_enabled 
| rename numberOfCores AS pCPU numberOfVirtualCores AS vCPU version AS Version os_name AS "OS" os_version AS "OS Version" Splunk_Instance AS "Splunk Instance" Splunk_Roles AS "Splunk Roles" startup_time AS "OS Startup Time" isForwarding AS "is Forwarding" ulimits_open_files AS "Ulimits Open Files" ulimits_stack_size AS "Ulimits Stack Size" ulimits_user_processes AS "Ulimits User Processes" transparent_hugepages_defrag AS "THP Defrag Status" transparent_hugepages_effective_state AS "THP State" transparent_hugepages_enabled AS "THP Status"</query>
        </search>
        <option name="count">5</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">false</option>
        <format type="number" field="Memory">
          <option name="unit">GB</option>
        </format>
        <format type="color" field="Splunk Instance">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Splunk Roles">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Version">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="pCPU">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="vCPU">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Memory">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="OS">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="OS Version">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="OS Startup Time">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="is Forwarding">
          <colorPalette type="map">{"0":#DC4E41,"1":#53A051}</colorPalette>
        </format>
        <format type="number" field="Ulimits Open Files">
          <option name="precision">0</option>
        </format>
        <format type="number" field="Ulimits Stack Size">
          <option name="precision">0</option>
        </format>
        <format type="number" field="Ulimits User Processes">
          <option name="precision">0</option>
        </format>
        <format type="color" field="Ulimits Open Files">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Ulimits Stack Size">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Ulimits User Processes">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="THP Defrag Status">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="THP State">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="THP Status">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
      </table>
    </panel>
  </row>
</form>